args.seed :  0
args.device :  cuda:3
args.train:  True
args.infer:  False
args.file_path:  /home/emforce77/TabFormer-main/modular_regression/multiple_scenario_data_fin2.xml
Data dimension: 300, Max sequence length: 30, num_intent : 7
expanded_train_data_num 9663
expanded_val_data_num 2040
expanded_test_data_num 2050
Data Split Over
col_dim 5 region_len 60 sequence_len 30 num_classes 445
Filtered data count: 111
train_loader
create_model
The model has 27,724,935 trainable parameters
trainer
Epoch [1/300], Loss: 329.6439, Val Loss: 245.0039, MAE: 6.6504, RMSE: 15.6518, Non-zero MAE: 21.6104, Non-zero RMSE: 32.7353, Sequence Accuracy: 0.5371, Non-zero Accuracy: 0.0158, Intent Accuracy: 0.8647
Epoch [2/300], Loss: 218.0683, Val Loss: 192.1108, MAE: 6.1091, RMSE: 13.8590, Non-zero MAE: 19.7094, Non-zero RMSE: 28.4604, Sequence Accuracy: 0.5494, Non-zero Accuracy: 0.0129, Intent Accuracy: 0.8574
Epoch [3/300], Loss: 190.7890, Val Loss: 182.6997, MAE: 5.9651, RMSE: 13.5145, Non-zero MAE: 19.6551, Non-zero RMSE: 27.9175, Sequence Accuracy: 0.5258, Non-zero Accuracy: 0.0111, Intent Accuracy: 0.8520
Epoch [4/300], Loss: 183.9083, Val Loss: 170.8313, MAE: 5.8035, RMSE: 13.0673, Non-zero MAE: 19.3852, Non-zero RMSE: 27.0866, Sequence Accuracy: 0.5249, Non-zero Accuracy: 0.0103, Intent Accuracy: 0.8593
Epoch [5/300], Loss: 174.9850, Val Loss: 172.4713, MAE: 5.7982, RMSE: 13.1305, Non-zero MAE: 19.5007, Non-zero RMSE: 27.3122, Sequence Accuracy: 0.5286, Non-zero Accuracy: 0.0106, Intent Accuracy: 0.8569
Epoch [6/300], Loss: 174.0722, Val Loss: 171.0326, MAE: 5.8670, RMSE: 13.0751, Non-zero MAE: 19.2973, Non-zero RMSE: 26.9892, Sequence Accuracy: 0.5145, Non-zero Accuracy: 0.0105, Intent Accuracy: 0.8598
Epoch [7/300], Loss: 174.0296, Val Loss: 171.6251, MAE: 5.9082, RMSE: 13.0970, Non-zero MAE: 19.2439, Non-zero RMSE: 26.9527, Sequence Accuracy: 0.5142, Non-zero Accuracy: 0.0105, Intent Accuracy: 0.8588
Epoch [8/300], Loss: 170.7583, Val Loss: 165.5843, MAE: 5.7441, RMSE: 12.8660, Non-zero MAE: 19.2997, Non-zero RMSE: 26.7217, Sequence Accuracy: 0.5156, Non-zero Accuracy: 0.0106, Intent Accuracy: 0.8598
Epoch [9/300], Loss: 168.8328, Val Loss: 165.9895, MAE: 5.8211, RMSE: 12.8815, Non-zero MAE: 19.1214, Non-zero RMSE: 26.6585, Sequence Accuracy: 0.5068, Non-zero Accuracy: 0.0110, Intent Accuracy: 0.8569
Epoch [10/300], Loss: 169.2695, Val Loss: 165.2790, MAE: 5.7655, RMSE: 12.8535, Non-zero MAE: 19.2772, Non-zero RMSE: 26.6808, Sequence Accuracy: 0.5021, Non-zero Accuracy: 0.0095, Intent Accuracy: 0.8598
Epoch [11/300], Loss: 168.1299, Val Loss: 166.6553, MAE: 5.8420, RMSE: 12.9062, Non-zero MAE: 19.1459, Non-zero RMSE: 26.6992, Sequence Accuracy: 0.4909, Non-zero Accuracy: 0.0105, Intent Accuracy: 0.8574
Epoch [12/300], Loss: 167.2137, Val Loss: 169.4046, MAE: 5.9164, RMSE: 13.0132, Non-zero MAE: 19.0587, Non-zero RMSE: 26.6810, Sequence Accuracy: 0.4960, Non-zero Accuracy: 0.0102, Intent Accuracy: 0.8574
Epoch [13/300], Loss: 166.9871, Val Loss: 167.0724, MAE: 5.8831, RMSE: 12.9231, Non-zero MAE: 19.0580, Non-zero RMSE: 26.5516, Sequence Accuracy: 0.4948, Non-zero Accuracy: 0.0109, Intent Accuracy: 0.8569
Epoch [14/300], Loss: 165.0877, Val Loss: 161.1661, MAE: 5.8389, RMSE: 12.6932, Non-zero MAE: 18.8887, Non-zero RMSE: 26.0733, Sequence Accuracy: 0.4895, Non-zero Accuracy: 0.0105, Intent Accuracy: 0.8574
Epoch [15/300], Loss: 161.9808, Val Loss: 161.7290, MAE: 5.8460, RMSE: 12.7164, Non-zero MAE: 18.9122, Non-zero RMSE: 26.1838, Sequence Accuracy: 0.4890, Non-zero Accuracy: 0.0106, Intent Accuracy: 0.8843
Epoch [16/300], Loss: 162.3279, Val Loss: 161.8502, MAE: 5.8931, RMSE: 12.7197, Non-zero MAE: 18.8662, Non-zero RMSE: 26.0303, Sequence Accuracy: 0.4801, Non-zero Accuracy: 0.0111, Intent Accuracy: 0.8814
Epoch [17/300], Loss: 161.6657, Val Loss: 161.4003, MAE: 5.8380, RMSE: 12.7027, Non-zero MAE: 18.9039, Non-zero RMSE: 26.0555, Sequence Accuracy: 0.4861, Non-zero Accuracy: 0.0113, Intent Accuracy: 0.8598
Epoch [18/300], Loss: 161.0410, Val Loss: 161.6678, MAE: 5.8960, RMSE: 12.7129, Non-zero MAE: 18.7743, Non-zero RMSE: 25.9593, Sequence Accuracy: 0.4843, Non-zero Accuracy: 0.0109, Intent Accuracy: 0.8578
Epoch [19/300], Loss: 161.7678, Val Loss: 162.0573, MAE: 5.8994, RMSE: 12.7290, Non-zero MAE: 18.8147, Non-zero RMSE: 25.9792, Sequence Accuracy: 0.4822, Non-zero Accuracy: 0.0104, Intent Accuracy: 0.8574
Epoch [20/300], Loss: 161.2880, Val Loss: 161.0077, MAE: 5.8541, RMSE: 12.6876, Non-zero MAE: 18.8456, Non-zero RMSE: 26.0840, Sequence Accuracy: 0.4760, Non-zero Accuracy: 0.0109, Intent Accuracy: 0.8578
Epoch [21/300], Loss: 159.9499, Val Loss: 160.3843, MAE: 5.8287, RMSE: 12.6616, Non-zero MAE: 18.7821, Non-zero RMSE: 26.0196, Sequence Accuracy: 0.4788, Non-zero Accuracy: 0.0112, Intent Accuracy: 0.8574
Epoch [22/300], Loss: 159.2407, Val Loss: 161.4380, MAE: 5.8650, RMSE: 12.7043, Non-zero MAE: 18.7942, Non-zero RMSE: 26.0063, Sequence Accuracy: 0.4858, Non-zero Accuracy: 0.0120, Intent Accuracy: 0.8574
Epoch [23/300], Loss: 159.5481, Val Loss: 162.1286, MAE: 5.8321, RMSE: 12.7314, Non-zero MAE: 18.9524, Non-zero RMSE: 26.1444, Sequence Accuracy: 0.4791, Non-zero Accuracy: 0.0107, Intent Accuracy: 0.8569
Epoch [24/300], Loss: 159.3005, Val Loss: 160.1892, MAE: 5.8706, RMSE: 12.6548, Non-zero MAE: 18.7431, Non-zero RMSE: 25.9367, Sequence Accuracy: 0.4763, Non-zero Accuracy: 0.0103, Intent Accuracy: 0.8701
Epoch [25/300], Loss: 159.3879, Val Loss: 161.3338, MAE: 5.8009, RMSE: 12.7010, Non-zero MAE: 18.8846, Non-zero RMSE: 26.1630, Sequence Accuracy: 0.4862, Non-zero Accuracy: 0.0105, Intent Accuracy: 0.8578
Epoch [26/300], Loss: 159.4015, Val Loss: 160.5913, MAE: 5.8287, RMSE: 12.6693, Non-zero MAE: 18.8411, Non-zero RMSE: 26.0321, Sequence Accuracy: 0.4631, Non-zero Accuracy: 0.0105, Intent Accuracy: 0.8500
Epoch [27/300], Loss: 158.3311, Val Loss: 159.0671, MAE: 5.7822, RMSE: 12.6093, Non-zero MAE: 18.8193, Non-zero RMSE: 26.0229, Sequence Accuracy: 0.4674, Non-zero Accuracy: 0.0107, Intent Accuracy: 0.8525
Epoch [28/300], Loss: 158.6303, Val Loss: 159.6731, MAE: 5.8122, RMSE: 12.6334, Non-zero MAE: 18.7833, Non-zero RMSE: 25.9433, Sequence Accuracy: 0.4655, Non-zero Accuracy: 0.0106, Intent Accuracy: 0.8574
Epoch [29/300], Loss: 158.8197, Val Loss: 158.4236, MAE: 5.8235, RMSE: 12.5840, Non-zero MAE: 18.6731, Non-zero RMSE: 25.8352, Sequence Accuracy: 0.4614, Non-zero Accuracy: 0.0111, Intent Accuracy: 0.8574
Epoch [30/300], Loss: 158.3153, Val Loss: 159.4564, MAE: 5.8571, RMSE: 12.6254, Non-zero MAE: 18.7323, Non-zero RMSE: 25.9300, Sequence Accuracy: 0.4627, Non-zero Accuracy: 0.0111, Intent Accuracy: 0.8574
Epoch [31/300], Loss: 158.2737, Val Loss: 160.1640, MAE: 5.8717, RMSE: 12.6527, Non-zero MAE: 18.7115, Non-zero RMSE: 25.9212, Sequence Accuracy: 0.4598, Non-zero Accuracy: 0.0116, Intent Accuracy: 0.8569
Epoch [32/300], Loss: 158.3077, Val Loss: 160.8891, MAE: 5.8427, RMSE: 12.6814, Non-zero MAE: 18.7675, Non-zero RMSE: 26.0175, Sequence Accuracy: 0.4730, Non-zero Accuracy: 0.0108, Intent Accuracy: 0.8564
Epoch [33/300], Loss: 158.5314, Val Loss: 161.2315, MAE: 5.9311, RMSE: 12.6948, Non-zero MAE: 18.6062, Non-zero RMSE: 25.8770, Sequence Accuracy: 0.4603, Non-zero Accuracy: 0.0117, Intent Accuracy: 0.8525
Epoch [34/300], Loss: 158.5348, Val Loss: 160.0395, MAE: 5.8182, RMSE: 12.6473, Non-zero MAE: 18.8080, Non-zero RMSE: 26.0037, Sequence Accuracy: 0.4642, Non-zero Accuracy: 0.0111, Intent Accuracy: 0.8529
Epoch [35/300], Loss: 157.8835, Val Loss: 161.2667, MAE: 5.8462, RMSE: 12.6959, Non-zero MAE: 18.7714, Non-zero RMSE: 26.0313, Sequence Accuracy: 0.4708, Non-zero Accuracy: 0.0103, Intent Accuracy: 0.8569
Epoch [36/300], Loss: 157.7983, Val Loss: 159.8596, MAE: 5.8865, RMSE: 12.6402, Non-zero MAE: 18.5647, Non-zero RMSE: 25.8109, Sequence Accuracy: 0.4592, Non-zero Accuracy: 0.0113, Intent Accuracy: 0.8574
Epoch [37/300], Loss: 157.4003, Val Loss: 159.6247, MAE: 5.8413, RMSE: 12.6311, Non-zero MAE: 18.7037, Non-zero RMSE: 25.8868, Sequence Accuracy: 0.4607, Non-zero Accuracy: 0.0110, Intent Accuracy: 0.8529
Epoch [38/300], Loss: 157.5469, Val Loss: 159.6185, MAE: 5.8195, RMSE: 12.6310, Non-zero MAE: 18.7588, Non-zero RMSE: 26.0148, Sequence Accuracy: 0.4599, Non-zero Accuracy: 0.0114, Intent Accuracy: 0.8578
Epoch [39/300], Loss: 157.5563, Val Loss: 160.2382, MAE: 5.8422, RMSE: 12.6557, Non-zero MAE: 18.7001, Non-zero RMSE: 25.9663, Sequence Accuracy: 0.4668, Non-zero Accuracy: 0.0105, Intent Accuracy: 0.8525
Epoch [40/300], Loss: 157.1627, Val Loss: 160.4818, MAE: 5.8832, RMSE: 12.6658, Non-zero MAE: 18.6334, Non-zero RMSE: 25.8957, Sequence Accuracy: 0.4597, Non-zero Accuracy: 0.0119, Intent Accuracy: 0.8569
Epoch [41/300], Loss: 156.6669, Val Loss: 161.5410, MAE: 5.8634, RMSE: 12.7073, Non-zero MAE: 18.7750, Non-zero RMSE: 26.1142, Sequence Accuracy: 0.4586, Non-zero Accuracy: 0.0106, Intent Accuracy: 0.8578
Epoch [42/300], Loss: 157.2338, Val Loss: 159.5618, MAE: 5.8432, RMSE: 12.6288, Non-zero MAE: 18.7368, Non-zero RMSE: 25.9207, Sequence Accuracy: 0.4574, Non-zero Accuracy: 0.0106, Intent Accuracy: 0.8525
Epoch [43/300], Loss: 157.1945, Val Loss: 160.1394, MAE: 5.8480, RMSE: 12.6512, Non-zero MAE: 18.7536, Non-zero RMSE: 25.9381, Sequence Accuracy: 0.4631, Non-zero Accuracy: 0.0109, Intent Accuracy: 0.8574
Epoch [44/300], Loss: 157.3723, Val Loss: 160.2293, MAE: 5.8675, RMSE: 12.6552, Non-zero MAE: 18.7003, Non-zero RMSE: 25.9537, Sequence Accuracy: 0.4598, Non-zero Accuracy: 0.0113, Intent Accuracy: 0.8525
Epoch [45/300], Loss: 156.8227, Val Loss: 160.2752, MAE: 5.8488, RMSE: 12.6582, Non-zero MAE: 18.7400, Non-zero RMSE: 25.9725, Sequence Accuracy: 0.4689, Non-zero Accuracy: 0.0108, Intent Accuracy: 0.8574
Epoch [46/300], Loss: 156.4709, Val Loss: 161.7475, MAE: 5.8920, RMSE: 12.7152, Non-zero MAE: 18.7110, Non-zero RMSE: 26.0029, Sequence Accuracy: 0.4640, Non-zero Accuracy: 0.0110, Intent Accuracy: 0.8525
Epoch [47/300], Loss: 157.1746, Val Loss: 160.0683, MAE: 5.8588, RMSE: 12.6491, Non-zero MAE: 18.7222, Non-zero RMSE: 25.9213, Sequence Accuracy: 0.4572, Non-zero Accuracy: 0.0110, Intent Accuracy: 0.8564
Epoch [48/300], Loss: 157.1721, Val Loss: 161.1224, MAE: 5.8603, RMSE: 12.6912, Non-zero MAE: 18.7166, Non-zero RMSE: 26.0291, Sequence Accuracy: 0.4567, Non-zero Accuracy: 0.0114, Intent Accuracy: 0.8520
Epoch [49/300], Loss: 156.6701, Val Loss: 160.8739, MAE: 5.8982, RMSE: 12.6813, Non-zero MAE: 18.7139, Non-zero RMSE: 25.9676, Sequence Accuracy: 0.4565, Non-zero Accuracy: 0.0111, Intent Accuracy: 0.8569
Early stopping triggered at epoch 49
Best model saved as './training_results_final2/vanillatf_best_model.pth'
Test Results - Loss: 171.9174, MAE: 5.9446, RMSE: 13.0165, Non-zero MAE: 19.4724, Non-zero RMSE: 27.0947, Sequence Accuracy: 0.4591, Non-zero Accuracy: 0.0104, Intent Accuracy: 0.8327
